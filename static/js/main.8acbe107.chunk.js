(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,a){},105:function(e,t,a){},111:function(e,t){},113:function(e,t){},146:function(e,t){},147:function(e,t){},192:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),i=a(17),l=a.n(i),s=(a(104),a(93)),c=a(22),r=a(38),d=a(39),_=a(96),m=a(94),u=a(98),h=(a(105),a(31)),x=a(30),b=(a(189),a(23)),v=a(97);var g=function(e){return o.a.createElement(b.a,Object.assign({},e,{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),o.a.createElement(b.a.Header,{closeButton:!0},o.a.createElement(b.a.Title,{id:"contained-modal-title-vcenter"},"Instructions")),o.a.createElement(b.a.Body,null,o.a.createElement("ol",null,o.a.createElement("li",null,"Use a USB MIDI device or follow these instructions for ",o.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.ableton.com/hc/en-us/articles/209774225-How-to-setup-a-virtual-MIDI-bus"},"setting up an IAC Driver / virtual Midi")),o.a.createElement("li",null,"Use in well lit environment"),o.a.createElement("li",null,"Wait for Camera to load"),o.a.createElement("li",null,"Checking a send box will start receving data from hand tracking and sending midi signal "),o.a.createElement("li",null,"Adjust CTRL value to get hand tracking value in between 0 - 127 or desired range"),o.a.createElement("li",null,"Use confidence range to adjust hand detection confidence"),o.a.createElement("li",null,"Have fun!"))),o.a.createElement(b.a.Footer,null,o.a.createElement(v.a,{onClick:e.onHide},"Close")))},f=function(e){return o.a.createElement("input",Object.assign({type:"checkbox",name:e.name},e))},p=function(e){return o.a.createElement("input",Object.assign({type:"range",min:"0",max:"1",value:"1",step:"0.05"},e))},E=function(e){return o.a.createElement("input",Object.assign({type:"range",min:"1",max:"600",step:"1"},e))},C=function(e){return o.a.createElement("select",Object.assign({name:"midiInput"},e),e.midioutputs.map(function(e,t){return o.a.createElement("option",{key:t},e.name)}))},y=function(e){return o.a.createElement("select",Object.assign({name:"handSelect"},e),o.a.createElement("option",{key:1,value:1},"1"),o.a.createElement("option",{key:2,value:2},"2"))},S=function(e){return o.a.createElement("select",Object.assign({name:"videoSourceSelect"},e),o.a.createElement("option",{key:1,value:"camera"}," camera"),o.a.createElement("option",{key:2,defaultValue:!0,value:"file"},"Video File"))},N=function(e){return"camera"===e.videoSource?o.a.createElement("video",{key:e.videoSource,controls:!0,autoPlay:!0,width:"640",height:"640",className:"videobox canvasboxHidden",id:"myvideo",muted:!0}):o.a.createElement("video",{key:e.videoSource,autoPlay:!0,width:"640",height:"640",className:"videobox canvasboxHidden",id:"myvideo",loop:!0,muted:!0},o.a.createElement("source",{src:"camera"===e.videoSource?null:e.src,type:"video/mp4"}))},O=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(_.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){"checkbox"===e.target.type?a.setState(Object(c.a)({},e.target.name,!a.state[e.target.name])):a.setState(Object(c.a)({},e.target.name,parseInt(e.target.value)))},a.handleModelChange=function(e){a.setState(Object(c.a)({},e.target.name,e.target.value),function(){a.modelParams=Object(s.a)({},a.modelParams,{maxNumBoxes:a.state.maxNumBoxes,scoreThreshold:parseFloat(a.state.confidenceRange)}),h.a(a.modelParams).then(function(e){a.model=e})})},a.handleVideoSourceChange=function(e){a.setState({videoSource:e.target.value}),"file"===e.target.value&&a.stopVideo(),"camera"===e.target.value&&a.loadTheModel()},a.handleVideoFile=function(e){var t=new FileReader,n=null;t.onload=function(e){n=e.target.result,a.setState({videoSourceFile:n},function(){a.state.video.load(),a.loadTheModel()})},t.readAsDataURL(e),a.newVideo=t.result,a.newVideo&&a.loadTheModel()},a.startVideo=function(){var e=a.state.video,t=a.state.canvas,n=a.state.context,o=!0;a.runDetection(e,t,n,o),h.b(e).then(function(e){console.log("video started",e),e&&(o=!0)})},a.stopVideo=function(){var e=a.state.video;h.c(e).then(function(e){}),a.loadTheModel()},a.runDetection=function(){var e=a.state.video,t=a.state.canvas,n=a.state.context;a.model.detect(e).then(function(o){if(a.model.renderPredictions(o,t,n,e),a.state.send_box_1_x&&o[0]){var i=o[0].bbox[0]+o[0].bbox[2]/2,l=i.toFixed(),s=(document.body.clientWidth*(i/e.width)/a.state.box_1_x_att).toFixed(),c=s>127?127:s;a.setState({box_1_x:c,box_1_x_val:l}),a.midiOutput&&a.state.send_box_1_x&&a.midiOutput.sendControlChange(1,c,"all")}if(a.state.send_box_1_y&&o[0]){var r=o[0].bbox[1]+o[0].bbox[3]/2,d=r.toFixed(),_=(document.body.clientHeight*(r/e.height)/a.state.box_1_y_att).toFixed(),m=_>127?127:_;a.setState({box_1_y:m,box_1_y_val:d}),a.midiOutput&&a.state.send_box_1_y&&a.midiOutput.sendControlChange(2,m,"all")}if(a.state.send_box_1_area&&o[0]){o[0].bbox[0],o[0].bbox[2];var u=(o[0].bbox[2]*o[0].bbox[3]).toFixed(),h=(u/10/a.state.box_1_area_att).toFixed(),x=h>127?127:h;a.setState({box_1_area:x,box_1_area_val:u}),a.midiOutput&&a.state.send_box_1_area&&a.midiOutput.sendControlChange(3,x,"all")}if(a.state.send_box_2_x&&o[1]){var b=o[1].bbox[0]+o[1].bbox[2]/2,v=(document.body.clientWidth*(b/e.width)/a.state.box_2_x_att).toFixed(),g=b.toFixed(),f=v>127?127:v;a.setState({box_2_x:f,box_2_x_val:g}),a.midiOutput&&a.state.send_box_2_x&&a.midiOutput.sendControlChange(4,f,"all")}if(a.state.send_box_2_y&&o[1]){var p=o[1].bbox[1]+o[1].bbox[3]/2,E=(document.body.clientHeight*(p/e.height)/a.state.box_2_y_att).toFixed(),C=p.toFixed(),y=E>127?127:E;a.setState({box_2_y:y,box_2_y_val:C}),a.midiOutput&&a.state.send_box_2_y&&a.midiOutput.sendControlChange(5,y,"all")}if(a.state.send_box_2_area&&o[1]){var S=o[1].bbox[2]*o[1].bbox[3],N=(S/a.state.box_2_area_att).toFixed(),O=S.toFixed(),k=N>127?127:N;a.setState({box_2_area:k,box_2_area_val:O}),a.midiOutput&&a.state.send_box_2_area&&a.midiOutput.sendControlChange(6,k,"all")}requestAnimationFrame(function(){a.runDetection(e,t,n,!0)})})},a.loadTheModel=function(){var e=a.state.video,t=a.state.canvas,n=a.state.context;h.a(a.modelParams).then(function(o){if(a.model=o,"file"===a.state.videoSource){var i=a.state.video;i.load(),i.play(),a.runDetection(e,t,n,!0)}else a.startVideo(e,t,n,!0)})},a.setModalShow=function(e){a.setState({showModal:e,setShowModal:e})},a.model=null,a.state={send_box_1_y:!1,send_box_1_x:!1,send_box_1_area:!1,send_box_2_y:!1,send_box_2_x:!1,send_box_2_area:!1,box_1_y_val:0,box_1_x_val:0,box_1_area_val:0,box_2_y_val:0,box_2_x_val:0,box_2_area_val:0,box_1_y_att:4,box_1_x_att:9,box_1_area_att:450,box_2_y_att:4,box_2_x_att:9,box_2_area_att:450,box_1_y_calc:0,box_1_x_calc:0,box_1_area_calc:0,box_2_y_calc:0,box_2_x_calc:0,box_2_area_calc:0,confidenceRange:.6,midiDevices:[],maxNumBoxes:1,showModal:!1,setModalShow:!1,videoSource:"file",videoSourceFile:null,video:null,canvas:null,context:null},a.modelParams={flipHorizontal:!0,maxNumBoxes:a.state.numberOfHands,iouThreshold:.5,scoreThreshold:a.state.confidenceRange},a}return Object(u.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=document.getElementById("myvideo"),t=document.getElementById("canvas"),a=t.getContext("2d");this.setState({video:e,canvas:t,context:a}),x.enable(function(e){e?console.log("WebMidi could not be enabled.",e):(console.log("WebMidi enabled!"),this.midiOutput=x.outputs[0],this.midiOutputs=x.outputs,console.log(this.midiOutputs[0].id),x.outputs[0]&&this.setState({midiDevices:this.midiOutputs}))}.bind(this)),this.loadTheModel()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"headerSpace"},"therimidi.js "),o.a.createElement("div",{className:"instructions",onClick:function(){return e.setModalShow(!0)}},"Instructions "),o.a.createElement(g,{show:this.state.showModal,onHide:function(){return e.setModalShow(!1)}}),o.a.createElement("div",{className:"midiSelect"},"  Select Midi Device: ",this.midiOutputs&&o.a.createElement(C,{midioutputs:this.midiOutputs?this.midiOutputs:null})),o.a.createElement("div",{className:this.midiOutput?"midiConnected":"midiDisconnected"}," ",this.midiOutput?this.midiOutput.state:null," "),o.a.createElement("div",{className:"controls"},o.a.createElement("div",{className:this.state.send_box_1_x?"paramControlon":"paramControloff"},o.a.createElement(f,{name:"send_box_1_x",className:"checkbox",checked:this.state.send_box_1_x,onChange:this.handleChange}),o.a.createElement("span",null," Box 1 X: ",this.state.box_1_x_val," / ",this.state.box_1_x_att," = ",this.state.box_1_x," "),o.a.createElement("div",{className:"attSliderContainer"},"ctrl: ",o.a.createElement(E,{name:"box_1_x_att",onChange:this.handleChange,className:"confidenceRange",value:this.state.box_1_x_att}))),o.a.createElement("div",{className:this.state.send_box_1_y?"paramControlon":"paramControloff"},o.a.createElement(f,{name:"send_box_1_y",className:"checkbox",checked:this.state.send_box_1_y,onChange:this.handleChange,togglevalue:"send_box_1_y"}),o.a.createElement("span",null,"Box 1 Y: ",this.state.box_1_y_val," / ",this.state.box_1_y_att," = ",this.state.box_1_y," "),o.a.createElement("div",{className:"attSliderContainer"},"ctrl: ",o.a.createElement(E,{name:"box_1_y_att",onChange:this.handleChange,className:"confidenceRange",value:this.state.box_1_y_att}))),o.a.createElement("div",{className:this.state.send_box_1_area?"paramControlon":"paramControloff"},o.a.createElement(f,{name:"send_box_1_area",className:"checkbox",checked:this.state.send_box_1_area,onChange:this.handleChange,togglevalue:"send_box_1_area"}),o.a.createElement("span",null,"Box 1 Size:  ",this.state.box_1_area_val," / ",this.state.box_1_area_att," = ",this.state.box_1_area," "),o.a.createElement("div",{className:"attSliderContainer"},"ctrl: ",o.a.createElement(E,{name:"box_1_area_att",onChange:this.handleChange,className:"confidenceRange",value:this.state.box_1_area_att}))),o.a.createElement("div",{className:this.state.send_box_2_x?"paramControlon":"paramControloff"},o.a.createElement(f,{name:"send_box_2_x",className:"checkbox",checked:this.state.send_box_2_x,onChange:this.handleChange,togglevalue:"send_box_2_x"}),o.a.createElement("span",null,"Box 2 X: ",this.state.box_2_x_val," / ",this.state.box_2_x_att," = ",this.state.box_2_x," "),o.a.createElement("div",{className:"attSliderContainer"},"ctrl: ",o.a.createElement(E,{name:"box_2_x_att",onChange:this.handleChange,className:"confidenceRange",value:this.state.box_2_x_att}))),o.a.createElement("div",{className:this.state.send_box_2_y?"paramControlon":"paramControloff"},o.a.createElement(f,{name:"send_box_2_y",className:"checkbox",checked:this.state.send_box_2_y,onChange:this.handleChange}),o.a.createElement("span",null,"Box 2 Y: ",this.state.box_2_y_val," / ",this.state.box_2_y_att," = ",this.state.box_2_y," "),o.a.createElement("div",{className:"attSliderContainer"},"ctrl: ",o.a.createElement(E,{name:"box_2_y_att",onChange:this.handleChange,className:"confidenceRange",value:this.state.box_2_y_att}))),o.a.createElement("div",{className:this.state.send_box_2_area?"paramControlon":"paramControloff"},o.a.createElement(f,{name:"send_box_2_area",className:"checkbox",checked:this.state.send_box_2_area,onChange:this.handleChange}),o.a.createElement("span",null,"Box 2 Size: ",this.state.box_2_area_val," / ",this.state.box_2_area_att," =  ",this.state.box_2_area," "),o.a.createElement("div",{className:"attSliderContainer"},"ctrl: ",o.a.createElement(E,{name:"box_2_area_att",onChange:this.handleChange,className:"confidenceRange",value:this.state.box_2_area_att}))),o.a.createElement("br",null),o.a.createElement("div",{className:"confidenceRangeContainer"},o.a.createElement("div",{className:"midiSelect"},"  Video Source: ",o.a.createElement(S,{value:this.state.videoSource,videosource:this.state.videoSource,name:"videoSourceSelect",onChange:this.handleVideoSourceChange})),"file"===this.state.videoSource&&o.a.createElement("input",{type:"file",id:"file",accept:".mp4",onChange:function(t){return e.handleVideoFile(t.target.files[0])}}),o.a.createElement("div",{className:"midiSelect"},"  Number of Hands: ",o.a.createElement(y,{name:"maxNumBoxes",onChange:this.handleModelChange})),"Confidence Range: ",this.state.confidenceRange,o.a.createElement("br",null),o.a.createElement(p,{name:"confidenceRange",onChange:this.handleModelChange,className:"confidenceRange",id:"confidenceRange",value:this.state.confidenceRange}))),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("canvas",{id:"canvas",className:"border canvasbox"}),o.a.createElement("br",null),o.a.createElement(N,{src:this.state.videoSourceFile,videoSource:this.state.videoSource}))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},99:function(e,t,a){e.exports=a(192)}},[[99,1,2]]]);
//# sourceMappingURL=main.8acbe107.chunk.js.map